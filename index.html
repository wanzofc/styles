<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>styles font </title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/TextPlugin.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script> 
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            padding: 20px;
            transition: background-color 0.3s, color 0.3s;
        }

        .styled-text {
            display: inline-block;
        }

        .dark-mode {
            background-color: #343a40;
            color: white;
        }

        .dark-mode .card {
            background-color: #495057;
            color: white;
        }

        .dark-mode .btn-primary {
            background-color: #0056b3;
            border-color: #0056b3;
        }
        .dark-mode .btn-primary:hover{
             background-color: #004793;
             border-color: #004793;
        }
       
    
        .toggle-theme {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
            font-size: 20px;
        }
    </style>
</head>

<body>
    
    <i id="themeToggle" class="fas fa-sun toggle-theme"></i>

    <div class="container">
        <h1 class="text-center mb-4">styles font by wanzofc</h1>

        <div class="mb-3">
            <label for="textInput" class="form-label">masukan teks nya:</label>
            <input type="text" class="form-control" id="textInput" placeholder="Type your text here">
        </div>

        <button id="applyButton" class="btn btn-primary mb-4">
            <i class="fas fa-magic"></i> submit
        </button>

        <div id="resultsContainer" class="row">
        </div>
        <div class="mt-4">
            <canvas id="myChart"></canvas>
        </div>
    </div>

    <script>
        $(document).ready(function () {
            function copyTextToClipboard(text) {
                navigator.clipboard.writeText(text).then(() => {
                    Swal.fire({
                        title: 'Copied!',
                        text: 'Text has been copied to clipboard',
                        icon: 'success',
                        timer: 1500,
                        showConfirmButton: false
                    });
                }).catch(err => {
                    console.error('Failed to copy text: ', err);
                     Swal.fire({
                        title: 'Error!',
                        text: 'Failed to copy text to clipboard',
                        icon: 'error',
                        confirmButtonText: 'Ok'
                    });
                });
            }
            $('#themeToggle').click(function() {
                $('body').toggleClass('dark-mode');
                if ($('body').hasClass('dark-mode')) {
                    $(this).removeClass('fa-sun').addClass('fa-moon');
                    
                } else {
                   $(this).removeClass('fa-moon').addClass('fa-sun');
                }
                
            });
            console.log("Current date (Moment.js):", moment().format("YYYY-MM-DD HH:mm:ss"));
            function createChart(data) {
                const ctx = document.getElementById('myChart').getContext('2d');
                const myChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: data.labels,
                        datasets: [{
                            label: '# of Characters',
                            data: data.values,
                            backgroundColor: [
                                'rgba(255, 99, 132, 0.2)',
                                'rgba(54, 162, 235, 0.2)',
                                'rgba(255, 206, 86, 0.2)',
                                'rgba(75, 192, 192, 0.2)',
                                'rgba(153, 102, 255, 0.2)',
                                'rgba(255, 159, 64, 0.2)'
                            ],
                            borderColor: [
                                'rgba(255, 99, 132, 1)',
                                'rgba(54, 162, 235, 1)',
                                'rgba(255, 206, 86, 1)',
                                'rgba(75, 192, 192, 1)',
                                'rgba(153, 102, 255, 1)',
                                'rgba(255, 159, 64, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                });
                return myChart;
            }


            let currentChart = null;
            $("#applyButton").click(function () {
                const text = $("#textInput").val();
                const apiKey = "accee5af"
                if (text) {
                    const apiUrl = `https://gemini.wanzofc.us.kg/api/tools/styletext?text=${text}&apikey=${apiKey}`;
                    fetch(apiUrl)
                        .then(response => {
                            if (!response.ok) {
                                throw new Error(`HTTP error! Status: ${response.status}`);
                            }
                            return response.json();
                        })
                        .then(data => {
                            if (data.status && data.result) {
                                $("#resultsContainer").empty(); 
                                data.result.forEach(item => {
                                    const card = $(`<div class="col-md-4 mb-3">
                                        <div class="card animate__animated animate__fadeIn">
                                            <div class="card-body d-flex justify-content-between align-items-center">
                                                <p class="card-text styled-text mb-0">${item.result}</p>
                                                <button class="btn btn-sm btn-outline-secondary copy-button" title="Copy Text"><i class="fas fa-copy"></i></button>
                                            </div>
                                        </div>
                                    </div>`);
                                    $("#resultsContainer").append(card);

                                    gsap.from(card, { opacity: 0, y: 50, duration: 0.5, ease: "power2.out", stagger: 0.1 });
                                        const textElement = card.find(".styled-text");
                                        gsap.fromTo(textElement, { text: "" }, { text: textElement.text(), duration: 1, delay: 0.2, ease: "power2.inOut" });
                                });
                                $(".copy-button").click(function () {
                                  const textToCopy = $(this).closest(".card-body").find(".styled-text").text();
                                  copyTextToClipboard(textToCopy);
                                }); 
                                 const words = text.split(/\s+/);
                                 const labels = words;
                                 const values = words.map(word => word.length);
                                 if(currentChart){
                                     currentChart.destroy();
                                 }
                                 const chartData = {
                                     labels: labels,
                                     values: values
                                 }

                                currentChart = createChart(chartData);

                            } else {
                                Swal.fire({
                                    title: 'Error!',
                                    text: 'Failed to fetch or invalid API response.',
                                    icon: 'error',
                                    confirmButtonText: 'Ok'
                                });
                            }
                        })
                        .catch(error => {
                            console.error('Error fetching data:', error);
                            Swal.fire({
                                title: 'Error!',
                                text: `Failed to fetch data. ${error}`,
                                icon: 'error',
                                confirmButtonText: 'Ok'
                            });
                        });
                } else {
                    Swal.fire({
                        title: 'Warning!',
                        text: 'Please enter some text!',
                        icon: 'warning',
                        confirmButtonText: 'Ok'
                    });
                }
            });
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>

</html>
