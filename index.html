<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegraph</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body {
            background-color: #f8f9fa;
        }

        .container {
            margin-top: 50px;
        }

        .upload-card {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .upload-card h2 {
            margin-bottom: 20px;
        }

        .result-area {
            margin-top: 20px;
            display: none;
        }

        .result-input {
            width: calc(100% - 60px); 
            display: inline-block;
            margin-right: 10px;
            border: 1px solid #ddd;
            padding: 0.375rem 0.75rem;
            border-radius: 4px;
        }
        .progress-bar{
          transition: width 0.3s ease
        }
        #loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .loader {
            border: 8px solid #f3f3f3;
            border-top: 8px solid #3498db;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 2s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.9.3/dropzone.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/11.0.5/swiper-bundle.min.css"/>
     <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body>
    <div id="loading-overlay" style="display: none;">
        <div class="loader"></div>
    </div>
    <div class="container" data-aos="fade-up" data-aos-duration="1000">
        <div class="row justify-center">
            <div class="col-md-6 animate__animated animate__fadeIn">
                <div class="upload-card bg-white shadow-md rounded-lg p-5">
                    <h2 class="text-center text-2xl font-bold mb-5">telegraph by wanzofc</h2>
                    <div id="upload-progress" class="progress mb-3" style="display: none;">
                        <div class="progress-bar bg-blue-500 text-white text-center" role="progressbar" style="width: 0%;" aria-valuenow="0"
                            aria-valuemin="0" aria-valuemax="100">0%</div>
                    </div>
                    <form id="upload-form" enctype="multipart/form-data">
                        <div class="form-group">
                            <input type="file" class="form-control-file border-gray-300 rounded-md px-2 py-1" id="image-upload" name="image"
                                accept="image/*" required>
                        </div>
                        <button type="submit" class="btn btn-primary btn-block bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-md">
                            <i class="fas fa-upload mr-2"></i> Upload
                        </button>
                    </form>
                     <div class="result-area" id="result-area">
                        <input type="text" class="result-input" id="result-link-input" readonly>
                        <button class="btn btn-secondary" id="copy-button">
                             <i class="fas fa-copy"></i> Copy
                        </button>
                     </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.2/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.all.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.9.3/dropzone.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/i18next/23.6.0/i18next.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/11.0.5/swiper-bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/immer@9.0.21/dist/immer.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/final-form@4.20.1/dist/final-form.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/unform@2.1.6/dist/unform.min.js"></script>
   <script src="https://testing-library.com/react-testing-library/"></script>
    <script src="https://cdn.jsdelivr.net/npm/@testing-library/jest-dom@6.1.4/dist/jest-dom.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cypress/13.5.0/cypress.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/playwright/1.40.0/playwright.min.js"></script>
     <script src="https://cdn.jsdelivr.net/npm/recharts@2.9.0/umd/Recharts.min.js"></script>
     <script src="https://cdn.jsdelivr.net/npm/@nivo/core@0.84.0/dist/nivo-core.umd.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/classnames@2.5.1/index.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/date-fns@2.30.0/index.min.js"></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/numeral.js/2.0.6/numeral.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.10/dayjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-router-dom@6.20.0/umd/react-router-dom.min.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/redux@4.2.1/dist/redux.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuex@4.1.0/dist/vuex.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/formik@2.4.5/dist/formik.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-hook-form/7.48.2/react-hook-form.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/yup@1.3.2/dist/yup.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/joi/17.11.0/joi.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/styled-components/6.1.1/styled-components.min.js"></script>
     <script src="https://emotion.sh/umd/emotion.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
     <script src="https://cdn.jsdelivr.net/npm/vue@3.3.4/dist/vue.global.min.js"></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.3/angular.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script>
    <script>
         const form = document.getElementById('upload-form');
        const imageInput = document.getElementById('image-upload');
        const resultDiv = document.getElementById('result-area');
        const resultLinkInput = document.getElementById('result-link-input');
        const progressDiv = document.getElementById('upload-progress');
        const progressBar = progressDiv.querySelector('.progress-bar');
          const loadingOverlay = document.getElementById('loading-overlay');
        const copyButton = document.getElementById('copy-button');
        const progressBarTween = gsap.to(progressBar, {
        duration: 1,
        width: '100%',
        ease: 'power2.out',
        paused: true,
        onUpdate: function(){
          progressBar.textContent = `${Math.round(this.progress() * 100)}%`
        },
        onComplete: function(){
         progressBar.textContent = "100%"
        }
      });
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(form);
             loadingOverlay.style.display = 'flex';
            progressDiv.style.display = 'block';
            resultDiv.style.display = 'none';
             progressBar.style.width = '0%';
          progressBarTween.play(0);
            try {
                const response = await fetch('/upload', {
                    method: 'POST',
                    body: formData,
                });
                if (!response.ok) {
                    throw new Error(`Upload Gagal: ${response.status} `)
                }
                const data = await response.json();
                if (data && data.links && data.links.length > 0) {
                    resultLinkInput.value = data.links[0];
                  resultDiv.style.display = 'flex';
                 Swal.fire({
                    icon: 'success',
                    title: i18next.t('upload_success'),
                  });
                } else {
                    Swal.fire({
                        icon: 'error',
                        title: i18next.t('upload_fail')
                    })
                  resultDiv.style.display = 'none';
                }
            } catch (error) {
                Swal.fire({
                    icon: 'error',
                    title: 'Error!',
                    text: i18next.t('upload_error') + error.message,
                })
                resultDiv.style.display = 'none';
            } finally {
                 progressBarTween.pause(0);
                 progressDiv.style.display = 'none';
                loadingOverlay.style.display = 'none';
            }

        });
      copyButton.addEventListener('click', () => {
          resultLinkInput.select();
           document.execCommand('copy');
         Swal.fire({
             icon: 'success',
              title: 'Link Copied!'
           })
      })
        imageInput.addEventListener('change', function (event) {
            const file = event.target.files[0];
            if (file) {
                const filesize = file.size / 1024;
                if (filesize > 200480) {
                    alert("Ukuran File terlalu Besar, Max 200 MB!");
                    imageInput.value = "";
                }
            }
        });
       AOS.init();
       i18next.init({
            lng: 'en',
             resources: {
              en: {
              translation: {
               upload_success: 'UPLOAD SUCCESSFUL',
               upload_fail: 'Upload Failed, No Link Returned!',
               upload_error: 'Error during upload:'
               }
              }
             }
        });
    </script>
</body>
</html>
